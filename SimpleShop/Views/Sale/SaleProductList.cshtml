@model SimpleShop.ViewModels.SaleInfoViewModel
@{
    ViewBag.Title = "SaleProductList";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>SaleProduct</h2>

<div class="table-responsive">
    <form name="cart">
        <table name="cart" id="autocomplete_table" style="width: 100%">
            <thead>
                <tr>
                    
                    <th>ProductName</th>
                    <th>Unit</th>
                    <th>Qty</th>
                    <th>Rate</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.productin != null && Model.productin.Count() > 0)
                {
                    
                    foreach (var product in Model.productin)
                    {
                        <tr>
                           
                            <td>@product.ProductId</td>
                            <td>PCS</td>
                            <td>
                                <input class="choose" type=number min=0 max=100 value="0">

                            </td>
                            <td><span class="price" />@product.Rate</td>
                            <td><span class="total" />@product.Amount</td>
                        </tr>
                        
                    }
                }
                else
                {
                    <tr>
                        <td colspan="4" class="text-center alert alert-danger">No products found.</td>
                    </tr>
                }
            </tbody>
        </table>
    </form>
</div>

<script>
    function increment() {
        document.getElementById('demoInput').stepUp();
    }
    function decrement() {
        document.getElementById('demoInput').stepDown();
    }
    calc_total();
    $(".choose").on('change', function () {
        var parent = $(this).closest('tr');
        var price = parseFloat($('.price', parent).text());
        var choose = parseFloat($('.choose', parent).val());

        $('.total', parent).text(choose * price);

        calc_total();
    });

    function calc_total() {
        var sum = 0;
        $(".total").each(function () {
            sum += parseFloat($(this).text());
        });
        $('#totalvalue').text(sum);
    }
      $("#saveBtn").click(function() {
        if ($("#createProduct").valid())
        {
            $.ajax({
                    type: "POST",
                    url: '@Url.Action("Create", "Product")',
                data: $("#createProduct").serialize()

            })
            .done(function (response) {
                $("#tableContainer").html(response),
                    $("#actionTable").html("");
                focusAction("tableContainer");
            })
            .fail(function (xmlHttpRequest, textStatus, errorThrown) {
                alert("Fail");
            });
        }
        else {
            swal({
                title: "Warning",
                text: "Please enter all valid data in fields.",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            });
        }
    });
</script>